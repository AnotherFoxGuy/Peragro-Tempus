SubDir TOP src client ;

SubInclude TOP src client network ;
SubInclude TOP src client gui ;

Description client : "Client" ;
Application client : [ Wildcard *.h *.cpp ] ;
ExternalLibs client : CEGUI CRYSTAL CEL ;
LinkWith client : client-network client-gui entity util ;

MsvcExternalLibrary client : "wsock32.lib" ;

if $(WSOCK32.LFLAGS) {
    LFlags client : $(WSOCK32.LFLAGS) ;
}

if [ Property build : projgen_version ] != 6
{
  SubVariant static ;
  
  Application client_static : [ Wildcard *.cpp *.h ] : independent noinstall ;
  CFlags client_static : [ FDefines CS_STATIC_LINKED ] ;
  MsvcDefine client_static : CS_STATIC_LINKED ;
  LFlags client_static : -lcrystalspace_staticplugins  -lcel_staticplugins ;
  LinkWith client_static : client-network client-gui entity util ;
  LinkStaticPlugins client_static :
    addon_celentity
    addon_celentitytpl
    addon_questdef
    bltest
    mgr_quests
    pfactormove
    pfdefcam
    pfinput
    pfinv
    pfengine
    pfmesh
    pfmove
    pfquest
    pftest
    pftools
    pftrigger
    pfzone
    stdphyslayer
    xmlpersist
  :
  ;

  cs_plugins_static = 
    ball
    ballldr
    bezier
    bezierldr
    bindoc
    bruteblock
    terrainldr
    bugplug
    cegui
    csconin
    csddsimg
    csfont
    csgifimg
    csjpgimg
    csparser
    cspngimg
    cssynldr
    dsplex
    dynavis
    emit
    emitldr
    engine
    engseq
    explo
    exploldr
    fire
    fireldr
    fontplex
    fountain
    fountldr
    frustvis
    freefnt2
    genmesh
    gl3d 
    glshader_arb 
    glshader_cg
    glshader_fixed
    gmeshanim
    gmeshldr
    gmeshskelanim
    haze
    hazeldr
    ieplex
    imgplex
    nullmesh
    opcode
    protomesh
    protomeshldr
    rain
    rainldr
    rendloop_loader
    rendstep_std
    reporter
    sequence
    shadermgr
    simpcon
    simpleformer
    simpleformerldr
    sndsyssoft
    sndsyswin
    sndmanager
    snow
    snowldr
    spiral
    spirldr
    spr2d
    spr2dldr
    spr3d
    spr3dldr
    sprcal3d 
    sprcal3dldr
    starldr
    stars
    stdpt
    stdrep
    thing
    thingldr
    vfs
    xmlread
    xmlshader
  ;

  if $(TARGET.OS) = "WIN32" { cs_plugins_static += glwin32 ; }

  LinkStaticPlugins client_static :  $(cs_plugins_static)  :  : CRYSTAL  ;

  ExternalLibs client_static : CRYSTAL CEL CEGUI ;
  MsvcExternalLibrary client_static : "wsock32.lib" ;
  MsvcExternalLibrary client_static : "libcrystalspace_staticplugins.lib libcel_staticplugins.lib" : release ;
  MsvcExternalLibrary client_static : "libcrystalspace_staticplugins_d.lib libcel_staticplugins_d.lib" : debug ;
  
  SubVariant ;
}
