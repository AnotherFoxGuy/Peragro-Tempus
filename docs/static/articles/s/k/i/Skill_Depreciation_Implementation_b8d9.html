<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- headlinks removed -->
	<link rel="shortcut icon" href="../../../../misc/favicon.ico"/>
    <title>Skill Depreciation Implementation - Peragro Tempus Wiki</title>
    <style type="text/css">/*<![CDATA[*/ @import "../../../../skins/offline/main.css"; /*]]>*/</style>
    <link rel="stylesheet" type="text/css" media="print" href="../../../../skins/common/commonPrint.css" />
    <!--[if lt IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE50Fixes.css";</style><![endif]-->
    <!--[if IE 5.5000]><style type="text/css">@import "../../../../skins/monobook/IE55Fixes.css";</style><![endif]-->
    <!--[if IE 6]><style type="text/css">@import "../../../../skins/monobook/IE60Fixes.css";</style><![endif]-->
    <!--[if IE]><script type="text/javascript" src="../../../../skins/common/IEFixes.js"></script>
    <meta http-equiv="imagetoolbar" content="no" /><![endif]-->
    <script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/md5.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/utf8.js"></script>
    <script type="text/javascript" src="../../../../skins/offline/lookup.js"></script>
    <script type="text/javascript" src="../../../../raw/gen.js"></script>        <style type="text/css">/*<![CDATA[*/
@import "../../../../raw/MediaWiki%7ECommon.css";
@import "../../../../raw/MediaWiki%7EMonobook.css";
@import "../../../../raw/gen.css";
/*]]>*/</style>          </head>
  <body
    class="page-Skill_Depreciation_Implementation">
    <div id="globalWrapper">
      <div id="column-content">
	<div id="content">
	  <a name="top" id="contentTop"></a>
	        <h1 class="firstHeading">Skill Depreciation Implementation</h1>
	  <div id="bodyContent">
	    <h3 id="siteSub">From Peragro Tempus Wiki</h3>
	    <div id="contentSub"></div>
	    	    	    <!-- start content -->
	    <p><a href="../../../../articles/s/k/i/Skills.html" class="mw-redirect" title="Skills">Skills</a>
</p>
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Skill_Depriciation"><span class="tocnumber">1</span> <span class="toctext">Skill Depriciation</span></a></li>
<li class="toclevel-1"><a href="#Specialization_Depriciation"><span class="tocnumber">2</span> <span class="toctext">Specialization Depriciation</span></a></li>
<li class="toclevel-1"><a href="#Improving_Depriciated_Skills_and_specialization"><span class="tocnumber">3</span> <span class="toctext">Improving Depriciated Skills and specialization</span></a>
<ul>
<li class="toclevel-2"><a href="#Example"><span class="tocnumber">3.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Skill_Depriciation"></a><h1> <span class="mw-headline">Skill Depriciation</span></h1>
<pre>
import time
import random

import os
from os import system

#==== [ System ] ========================================================

if os.name == 'nt':
    import msvcrt
    def getkey():
        if msvcrt.kbhit():
            z = msvcrt.getch()
            if z == '\0' or z == '\xe0':    #functions keys
                msvcrt.getch()
            else:
                if z == '\r':
                    return '\n'
                return z
        return None
    def ClearScreen():
        system(&quot;cls&quot;)
    
elif os.name == 'posix':
    import termios, sys, os
    fd = sys.stdin.fileno()
    old = termios.tcgetattr(fd)
    new = termios.tcgetattr(fd)
    new[3] = new[3] &amp; ~termios.ICANON &amp; ~termios.ECHO
    new[6][termios.VMIN] = 1
    new[6][termios.VTIME] = 0
    termios.tcsetattr(fd, termios.TCSANOW, new)
    def getkey():
        if select([fd],[],[],0)[0]:
            c = os.read(fd, 1)
        else:
            c = None
        return c
    def clenaup_console():
        termios.tcsetattr(fd, termios.TCSAFLUSH, old)
    sys.exitfunc = clenaup_console      #terminal modes have to be restored on exit...
    def ClearScreen():
        system(&quot;clear&quot;)

def GetTotalXPForLevel(level, mul):
	xp = 0
	for i in range(1,level+1):
		xp += (i*mul)
	return xp
	
def GetLevelAndProgress(xp, mul):
	level = 0
	while xp &gt;= (level+1) * mul:
		xp -= (level+1) * mul
		level += 1
	return level, xp
	
#==== [ AttributeBase ] ==================================================
# Base class for Ability and skill
class AttributeBase:
	def __init__(self, mul, name, xp):
		self.name = name
		self.xp = xp
		self.mul = mul
		
	def GetLevel(self):
		return GetLevelAndProgress(self.xp, self.mul)[0]
		
	def GetProgress(self):
		return GetLevelAndProgress(self.xp, self.mul)[1]
		
	def GetXP(self):
		return self.xp
			
	def __repr__(self):
		return &quot;%s&nbsp;%dxp&quot;&nbsp;% (self.name, self.xp)
	
#==== [ Ability ] =======================================================
# Agility, Endurance, Speed, Strength
# Resolve, Sapience
# Next level = level X 10
class Ability(AttributeBase):
	def __init__(self, name, xp):
		AttributeBase.__init__(self, 10, name, xp) 
		
	def AddXP(self, i):
		self.xp += i

#==== [ Skill ] =======================================================
# Weapon: One Handed: Axe, Blunt, Flail, Sword, Unarmed
# Next level = level X 3
class Skill(AttributeBase):
	def __init__(self, type, name, xp):
		AttributeBase.__init__(self, 3, name, xp)
		self.type = type
		self.timer = 0
		self.ResetTimer()
		self.maxXP = self.GetXP() #Max xp we ever had for this skill.
		
	def ResetTimer(self):
		level  = self.GetLevel()
		if level == 0:
			self.timer = 360000
		else:
			self.timer = 360000 / level # 100 hours / level
		
	def GetTimer(self):
		return self.timer
		
	def SetTimer(self, i):
		self.timer = i

	def AddXP(self, i):
		progress = i
		#Check for depricated xp.
		if (self.xp &lt; self.maxXP) and i &gt; 0:
			above = max(0,(self.xp + (i * self.mul)) - self.maxXP)
			below = ((i * self.mul) - above)	
			progress = 	below + max(0, i - below)
		#Add the xp.
		self.xp += progress
		#Set our new max.
		self.maxXP = max (self.xp, self.maxXP)
		self.ResetTimer()

	def __repr__(self):
		return &quot;%s:&nbsp;%s&nbsp;%dxp&quot;&nbsp;% (self.type, self.name, self.xp)


#==== [ Player ] =======================================================
class Player:
	def __init__(self):
		self.abilities 	= [Ability(&quot;Agility&quot;, 55), Ability(&quot;Endurance&quot;, 18), Ability(&quot;Speed&quot;, 0), Ability(&quot;Strength&quot;, 0)]
		self.abilities 	+= [Ability(&quot;Resolve&quot;, 0), Ability(&quot;Sapience&quot;, 0)]
		
		self.skills 	= [Skill(&quot;One Handed&quot;, &quot;Axe&quot;, 55), Skill(&quot;One Handed&quot;, &quot;Blunt&quot;, 20)]
		self.skills 	+= [Skill(&quot;One Handed&quot;, &quot;Flail&quot;, 0), Skill(&quot;One Handed&quot;, &quot;Sword&quot;, 0), Skill(&quot;One Handed&quot;, &quot;Unarmed&quot;, 0)]
		
		self.skills 	+= [Skill(&quot;Two Handed&quot;, &quot;Axe&quot;, 1), Skill(&quot;Two Handed&quot;, &quot;Blunt&quot;, 64)]
		self.skills 	+= [Skill(&quot;Two Handed&quot;, &quot;Polearm&quot;, 6), Skill(&quot;Two Handed&quot;, &quot;Sword&quot;, 80)]
		
		self.skills 	+= [Skill(&quot;Ranged&quot;, &quot;Bow&quot;, 0), Skill(&quot;Ranged&quot;, &quot;Crossbow&quot;, 0), Skill(&quot;Ranged&quot;, &quot;Thrown&quot;, 0)]
		
	def GetSkill(self, i):
		return self.skills[i]
		
	def GetSkills(self):
		return self.skills
		
	def GetSkillCount(self):
		return len(self.skills)
		
	def GetAbilities(self):
		return self.abilities
	
	def DepricationUpdate(self, elapsed):
		for skill in self.skills: 
			skill.SetTimer(skill.GetTimer() - elapsed)
			if skill.GetTimer() &lt;= 0 and skill.GetLevel() &gt; 1:
				xp = ( skill.GetXP() - GetTotalXPForLevel(skill.GetLevel()-1, 3) )
				skill.AddXP(-xp)  # current progress = 0, level - 1

	def __repr__(self):
		return &quot;Abilities:\n%s \n%s \nSkills:\n%s&quot;&nbsp;% (self.abilities[:4], self.abilities[4:], self.skills)

#==== [ Misc ] =======================================================				
def Input():
    time.sleep(0.13)
    ch = getkey()
    if ch == 'p':
        player.GetSkill(0).AddXP(2)
    if ch == 'r':
        global totalTime
        totalTime = 0
    if ch == 't':
        global type
        if type == 1: type = 0 
        else: type = 1
    if ch == 'y':
        global typeIndex
        typeIndex += 1
        if len(skillTypes)-1 &lt; typeIndex:
            typeIndex = 0
            
class VirtualClock:
	import time
	def __init__(self):
		self.clock = time.time()
		
	def GetElapsed(self):
		elapsed = time.time() - self.clock
		self.clock = time.time()
		return elapsed
		
def PrettyPrint(player, type, skillType):
	if type == 0:
		print &quot;--------------------------&quot;
		print &quot;| Abilities              |&quot;
		print &quot;==========================&quot;
		for ability in player.GetAbilities():
			name = (ability.name+&quot;      &quot;)[:10]
			xp = str(ability.GetXP()) + &quot;/&quot; + str(GetTotalXPForLevel(ability.GetLevel()+1, 10))
			level = (str(ability.GetLevel())+&quot;      &quot;)[:3]
			if len(xp) &lt; 7:
				xp = &quot; &quot;*(7-len(xp)) + xp
			print &quot;|&quot;, name, level, xp, &quot;|&quot;
			print &quot;--------------------------&quot;
	elif type == 1:
		print &quot;--------------------------&quot;
		skillstr = skillType + &quot; &quot;*(22-len(skillType))
		print &quot;|&quot;, skillstr, &quot;|&quot;
		print &quot;==========================&quot;
		for skill in player.GetSkills():
			if skill.type == skillType:
				name = (skill.name + &quot; &quot;*20)[:10]
				xp = str(skill.GetXP()) + &quot;/&quot; + str(GetTotalXPForLevel(skill.GetLevel()+1, 3))
				level = (str(skill.GetLevel())+&quot;      &quot;)[:3]
				if len(xp) &lt; 7:
					xp = &quot; &quot;*(7-len(xp)) + xp
				print &quot;|&quot;, name, level, xp, &quot;|&quot;
				print &quot;--------------------------&quot;
				
def PrintInstructions():
	print &quot;-----------------------------------------&quot;
	print &quot;| Skill and ability progression tester  |&quot;
	print &quot;=========================================&quot;
	print &quot;| Input:                                |&quot;
	print &quot;| p: Adds 2xp to Axe skill.             |&quot;
	print &quot;| r: Resets the time counter.           |&quot;
	print &quot;| t: Switch between ability and skill   |&quot;
	print &quot;| y: Switch between skill types         |&quot;
	print &quot;-----------------------------------------&quot;
	print
		

#==== [ Main ] =======================================================		
def Main():
	counter = 0
	vc = VirtualClock()

	while True:
		elapsed = vc.GetElapsed()
		
		global totalTime
		totalTime += elapsed
		
		Input()
		
		player.DepricationUpdate(elapsed*3600) # speed up *3600 =&gt; 1 sec = 1 hour
		
		ClearScreen()
		print str(totalTime).split(&quot;.&quot;)[0], &quot; hours have passed.&quot;
		PrettyPrint(player, type, skillTypes[typeIndex])
		print &quot;\n&quot;

type = 1 # 0 = Abilities, 1 = Skills
skillTypes = [&quot;One Handed&quot;, &quot;Two Handed&quot;, &quot;Ranged&quot;]
typeIndex = 0
totalTime = 0		
player = Player()

Main()
</pre>
<ul><li>p: Adds 2xp to Axe skill.
</li><li>r: Resets the time counter.
</li><li>t: Switch between ability and skill
</li><li>y: Switch between skill types
</li></ul>
<a name="Specialization_Depriciation"></a><h1> <span class="mw-headline">Specialization Depriciation</span></h1>
<ul><li><a href="../../../../articles/s/p/e/Specialization_Implementation_703c.html" title="Specialization Implementation">Specializations</a> take twice as long to depriciate (200/level rather than 100/level).
</li><li>A <a href="../../../../articles/h/o/b/Hobby_Implementation_bf24.html" title="Hobby Implementation">Hobby</a> protects its highest level specialization from depriciation (much as the skill itself is protected).
</li></ul>
<a name="Improving_Depriciated_Skills_and_specialization"></a><h1> <span class="mw-headline">Improving Depriciated Skills and specialization</span></h1>
<p>run when any experience is gained. (sub specialization for skill as appropriate)
</p>
<ul><li>If Current Experience {skill} &lt; or = max experience {skill}
<ul><li>then increase Xp by 3
<ul><li>if Current Experience {skill} &gt; max experience {skill}
<ul><li>then Current Experience {skill} = max experience {skill}
</li></ul>
</li></ul>
</li></ul>
</li></ul>
<a name="Example"></a><h2> <span class="mw-headline">Example</span></h2>
<p>The idea behind improving depreciated skills is that it should be easier to restore knowledge that you had. Ergo, when Xp replaces xp lost to depreciation you get more.
</p><p>A character starts with 55 xp in Axe. we'll assume that's the highest Xp level for Axe the character has ever had. if no other events occur, in the 20th hour the character's Xp will drop to 30 (base for level 4). now, if an event grants 1 experience point to the Axe skill because it is replacing "lost" knowledge (is lower than that max value) the amount of experience actually applied is multiplied (by 3). so long as that multiplied experience does not take their total above 55 (where they were before) they will continue getting multiplied xp. once they equal or exceed 55, Xp gains go back to normal. If they exceed 55, that number becomes the new "target."
</p>
<!-- 
NewPP limit report
Preprocessor node count: 8/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->
<div class="printfooter">
</div>
	    <div id="catlinks"><div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="../../../../articles/c/a/t/Special%7ECategories_101d.html" title="Special:Categories">Category</a>:&#32;<span dir='ltr'><a href="../../../../articles/c/o/d/Category%7ECode_d87b.html" title="Category:Code">Code</a></span></div></div></div>	    <!-- end content -->
	    <div class="visualClear"></div>
	  </div>
	</div>
      </div>
      <div id="column-one">
	<div id="p-cactions" class="portlet">
	  <h5>Views</h5>
	  <ul>
	    <li id="ca-nstab-main"
	       class="selected"	       ><a href="../../../../articles/s/k/i/Skill_Depreciation_Implementation_b8d9.html">Page</a></li><li id="ca-talk"
	       class="new"	       ><a href="../../../../articles/s/k/i/Talk%7ESkill_Depreciation_Implementation_a7db.html">Discussion</a></li><li id="ca-current"
	       	       ><a href="http://localhost/index.php/Skill_Depreciation_Implementation">Current revision</a></li>	  </ul>
	</div>
	<div class="portlet" id="p-logo">
	  <a style="background-image: url(../../../../misc/clock_half.png);"
	    href="../../../../index.html"
	    title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
	  <h5>Navigation</h5>
	  <div class='pBody'>
	    <ul>
	    	      <li id="n-mainpage-description"><a href="../../../../index.html">Main Page</a></li>
	     	      <li id="n-portal"><a href="../../../../articles/c/o/m/Peragro_Tempus_Wiki%7ECommunity_Portal_9ca7.html">Community portal</a></li>
	     	      <li id="n-currentevents"><a href="../../../../articles/c/u/r/Peragro_Tempus_Wiki%7ECurrent_events_57bd.html">Current events</a></li>
	     	      <li id="n-help"><a href="../../../../articles/c/o/n/Help%7EContents_22de.html">Help</a></li>
	     	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-SEARCH'>
	  <h5>SEARCH</h5>
	  <div class='pBody'>
	    <ul>
	    	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-TOOLBOX'>
	  <h5>TOOLBOX</h5>
	  <div class='pBody'>
	    <ul>
	    	    </ul>
	  </div>
	</div>
		<div class='portlet' id='p-LANGUAGES'>
	  <h5>LANGUAGES</h5>
	  <div class='pBody'>
	    <ul>
	    	    </ul>
	  </div>
	</div>
		<div id="p-search" class="portlet">
	  <h5><label for="searchInput">Search</label></h5>
	  <div id="searchBody" class="pBody">
	    <form action="javascript:goToStatic(3)" id="searchform"><div>
	      <input id="searchInput" name="search" type="text"
	        accesskey="f" value="" />
	      <input type='submit' name="go" class="searchButton" id="searchGoButton"
	        value="Go" />
	    </div></form>
	  </div>
	</div>
	      </div><!-- end of the left (by default at least) column -->
      <div class="visualClear"></div>
      <div id="footer">
    <div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>		<ul id="f-list">
	  	  	  <li id="f-credits">This page was last modified 16:01, 28 September 2008 by <a href="../../../../articles/c/y/a/User%7ECyaNox_4c16.html" title="User:CyaNox">Mark Sanders</a>. Based on work by <a href="../../../../articles/s/u/e/User%7ESueastside_0e95.html" title="User:Sueastside">Jelle Hellemans</a> and <a href="../../../../articles/d/a/r/User%7EDarker_Dreams_6a0a.html" title="User:Darker Dreams">Ryan Robinson</a>.</li>	  	  <li id="f-about"><a href="../../../../articles/a/b/o/Peragro_Tempus_Wiki%7EAbout_5c7d.html" title="Peragro Tempus Wiki:About">About Peragro Tempus Wiki</a></li>	  <li id="f-disclaimer"><a href="../../../../articles/g/e/n/Peragro_Tempus_Wiki%7EGeneral_disclaimer_934d.html" title="Peragro Tempus Wiki:General disclaimer">Disclaimers</a></li>	  	</ul>
      </div>
    </div>
  </body>
</html>
